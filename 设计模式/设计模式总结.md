---
typora-root-url: ..\img
---

# 设计模式总结

## 一、概览

## 二、创建型

### 1、AbstractFactory 抽象工厂模式

#### 意图

提供一个创建一系列相关或相互依赖对象的接口，而无需指定具体的类。

#### 动机

支持多种视觉风格的用户界面工具包。保证风格标准间的可移植性。

#### 适用性

* 一个系统要独立与他的产品创建、组合和表示时。
* 一个系列要由多个产品系列中的一个来配置时。
* 当你要强调一系列相关的产品对象的设计以便进行联合使用时。
* 当你提供一个产品类库，而只想显示它们的接口而不是全部实现时。

#### 结构

![1624406711959](/1624406711959.png)

* AbstractFactory 声明一个创建抽象产品的操作接口
* ConcreteFactory 实现常见具体产品对象的操作
* AbstractProduct 为一类产品对象声明一个接口
* ConcreteProduct 产品对象
* Client 仅使用Abustract接口

#### 效果

1. 分离了使用者和具体类
2. 易于交换产品系列
3. 有利于产品的一致性
4. 难以支持心中类产品：需要重写所有工厂类

#### 实现

1. 将工厂作为单例
2. AbstractFactory仅声明一个创建产品的接口，每个产品定义一个工厂方法。
3. 定义可扩展工厂：AbstractFactory仅提供一个接口，接口接受参数，根据参数确定创建的类型。需要使用类型转换，有一定风险。

#### 相关模式

AbstractFactory类通常用工厂方法实现，也可以用原型方法实现。具体的工厂通常是单例。

### 2、BUILDER 生成器

#### 意图

分离复杂对象的构建与表示。

* 构建：类的创建和构成方式
* 表示：具体的成果、效果

#### 动机

阅读器应能将RTF转换为多种正文格式。深度学习框架中模型的构建。

#### 适用性

* 当**创建复杂对象的算法**需要独立于**对象的组成部分和它们的装配方式**时
* 当构造过程必须允许被构造的对象有不同的表示时。

#### 结构

![builder](/builder.png)

#### 参与者

* Builder：
  * 为创建一个对象的各个部件指定抽象接口
* ConcreteBuilder：
  * 实现Builder接口创建对象
  * 定义它所常见的实例
  * 提供一个GET接口
* Director
  * 构造一个使用Builder接口的对象
* Product
  * 被构造的复杂对象
  * 包含定义组成部件的类，和装配成最终产品的接口

#### 协作

![builder-1](/builder-1.png)

#### 效果

1. 可以通过定义新的生成器，改变一个产品的内部表示。
2. 将构造代码和表示代码分开，提高了代码复用性。
3. 更精细的控制构造过程，Director控制Builder一步一步构成对象，最后才取出。

#### 相关模式

Builder和AbstractFactory相似，都可以创建复杂对象。Builder强调一步步构造复杂对象，AbstractFactory强调多个系列对象的创建。

Composite通常是用Builder生成的。



### 3、FACTORY METHOD 工厂方法

#### 意图

定义一个用于创建对象的接口，让子类决定实例化哪一个类。将类的实例化延迟到其子类。

**用一个独立的操作创建对象，这样子类才能重新定义他们的创建方式。**

#### 动机

在一个框架中，互相作用的抽象类不知道对方的具体实现。因此在一个抽象类的子类中实例化另一个抽象类的子类。这样他们就能够知道对方的信息了。创建另一个子类的方法就是工厂方法。

#### 适用性

* 当**一个类**不知道**它所必须创建的对象的类**的时候
* 当**一个类**希望由**他的子类**来指定**它所创建的对象**的时候
* 当类将常见对象的职责委托给多个帮助子类中的一个，并且希望哪个帮助子类是代理者。

#### 结构

![factory-a](/factory-a.png)

#### 参与者

* Product
  * 对象接口
* ConcreteProduct
  * 对象
* Creator
  * 声明工厂方法，该方法返回Product对象
  * 可以调用工厂方法创建一个Product
* ConcreteCreator
  * 重新定义工厂方法

#### 效果

* 为子类提供挂钩，方便扩展。
* 连接平行的类层次

![factory-b](/factory-b.png)

#### 实现

* 普通模式
* 参数化工厂：根据传入参数，创建对应子类。
* 模板：创建时传入模板，根据模板创建对象，避免过多的创建子工厂类

#### 相关模式

* AbstractFactory经常用工厂方法实现。
* 工厂方法常在TemplateMethods中被调用
* Prototypes不需要创建Creator的子类，但需要针对Product类的初始化操作。FactoryMethod不需要初始化操作。